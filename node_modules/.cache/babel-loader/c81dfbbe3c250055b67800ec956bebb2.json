{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\jiang\\\\Desktop\\\\around\\\\around-web\\\\src\\\\components\\\\AroundMap.js\";\nimport React from 'react';\nimport { withScriptjs, withGoogleMap, GoogleMap } from \"react-google-maps\";\nimport { AroundMarker } from './AroundMarker';\nimport { POS_KEY } from '../constants';\n\nclass NormalAroundMap extends React.Component {\n  constructor(...args) {\n    super(...args);\n\n    this.reloadMarker = () => {\n      const center = this.getCenter();\n      const radius = this.getRadius();\n      this.props.loadPostsByTopic(center, radius);\n    };\n\n    this.getMapRef = mapInstance => {\n      this.map = mapInstance;\n      window.map = mapInstance;\n    };\n  }\n\n  getCenter() {\n    const center = this.map.getCenter();\n    return {\n      lat: center.lat(),\n      lon: center.lng()\n    };\n  }\n\n  getRadius() {\n    const center = this.map.getCenter();\n    const bounds = this.map.getBounds();\n\n    if (center && bounds) {\n      const ne = bounds.getNorthEast();\n      const right = new window.google.maps.LatLng(center.lat(), ne.lng());\n      return 0.001 * window.google.maps.geometry.spherical.computeDistanceBetween(center, right);\n    }\n  }\n\n  render() {\n    const {\n      lat,\n      lon\n    } = JSON.parse(localStorage.getItem(POS_KEY));\n    return /*#__PURE__*/React.createElement(GoogleMap, {\n      ref: this.getMapRef,\n      defaultZoom: 11,\n      defaultCenter: {\n        lat,\n        lng: lon\n      },\n      onDragEnd: this.reloadMarker,\n      onZoomChanged: this.reloadMarker,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 13\n      }\n    }, this.props.posts.map(post => /*#__PURE__*/React.createElement(AroundMarker, {\n      post: post,\n      key: post.url,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 49\n      }\n    })));\n  }\n\n}\n\nexport const AroundMap = withScriptjs(withGoogleMap(NormalAroundMap));","map":{"version":3,"sources":["C:/Users/jiang/Desktop/around/around-web/src/components/AroundMap.js"],"names":["React","withScriptjs","withGoogleMap","GoogleMap","AroundMarker","POS_KEY","NormalAroundMap","Component","reloadMarker","center","getCenter","radius","getRadius","props","loadPostsByTopic","getMapRef","mapInstance","map","window","lat","lon","lng","bounds","getBounds","ne","getNorthEast","right","google","maps","LatLng","geometry","spherical","computeDistanceBetween","render","JSON","parse","localStorage","getItem","posts","post","url","AroundMap"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SACIC,YADJ,EAEIC,aAFJ,EAGIC,SAHJ,QAIO,mBAJP;AAKA,SAASC,YAAT,QAA6B,gBAA7B;AACA,SAASC,OAAT,QAAwB,cAAxB;;AAEA,MAAMC,eAAN,SAA8BN,KAAK,CAACO,SAApC,CAA8C;AAAA;AAAA;;AAAA,SAC1CC,YAD0C,GAC3B,MAAM;AACjB,YAAMC,MAAM,GAAG,KAAKC,SAAL,EAAf;AACA,YAAMC,MAAM,GAAG,KAAKC,SAAL,EAAf;AACA,WAAKC,KAAL,CAAWC,gBAAX,CAA4BL,MAA5B,EAAoCE,MAApC;AACH,KALyC;;AAAA,SAuB1CI,SAvB0C,GAuB7BC,WAAD,IAAiB;AACzB,WAAKC,GAAL,GAAWD,WAAX;AACAE,MAAAA,MAAM,CAACD,GAAP,GAAaD,WAAb;AACH,KA1ByC;AAAA;;AAO1CN,EAAAA,SAAS,GAAG;AACR,UAAMD,MAAM,GAAG,KAAKQ,GAAL,CAASP,SAAT,EAAf;AACA,WAAO;AAAES,MAAAA,GAAG,EAAEV,MAAM,CAACU,GAAP,EAAP;AAAqBC,MAAAA,GAAG,EAAEX,MAAM,CAACY,GAAP;AAA1B,KAAP;AACH;;AAEDT,EAAAA,SAAS,GAAG;AACR,UAAMH,MAAM,GAAG,KAAKQ,GAAL,CAASP,SAAT,EAAf;AACA,UAAMY,MAAM,GAAG,KAAKL,GAAL,CAASM,SAAT,EAAf;;AACA,QAAId,MAAM,IAAIa,MAAd,EAAsB;AAClB,YAAME,EAAE,GAAGF,MAAM,CAACG,YAAP,EAAX;AACA,YAAMC,KAAK,GAAG,IAAIR,MAAM,CAACS,MAAP,CAAcC,IAAd,CAAmBC,MAAvB,CAA8BpB,MAAM,CAACU,GAAP,EAA9B,EAA4CK,EAAE,CAACH,GAAH,EAA5C,CAAd;AACA,aAAO,QAAQH,MAAM,CAACS,MAAP,CAAcC,IAAd,CAAmBE,QAAnB,CAA4BC,SAA5B,CAAsCC,sBAAtC,CAA6DvB,MAA7D,EAAqEiB,KAArE,CAAf;AACH;AACJ;;AAQDO,EAAAA,MAAM,GAAG;AACL,UAAM;AAAEd,MAAAA,GAAF;AAAOC,MAAAA;AAAP,QAAec,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqBhC,OAArB,CAAX,CAArB;AACA,wBACI,oBAAC,SAAD;AACI,MAAA,GAAG,EAAE,KAAKU,SADd;AAEI,MAAA,WAAW,EAAE,EAFjB;AAGI,MAAA,aAAa,EAAE;AAAEI,QAAAA,GAAF;AAAOE,QAAAA,GAAG,EAAED;AAAZ,OAHnB;AAII,MAAA,SAAS,EAAE,KAAKZ,YAJpB;AAKI,MAAA,aAAa,EAAE,KAAKA,YALxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAOK,KAAKK,KAAL,CAAWyB,KAAX,CAAiBrB,GAAjB,CAAsBsB,IAAD,iBAAU,oBAAC,YAAD;AAAc,MAAA,IAAI,EAAEA,IAApB;AAA0B,MAAA,GAAG,EAAEA,IAAI,CAACC,GAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAA/B,CAPL,CADJ;AAWH;;AAzCyC;;AA4C9C,OAAO,MAAMC,SAAS,GAAGxC,YAAY,CAACC,aAAa,CAACI,eAAD,CAAd,CAA9B","sourcesContent":["import React from 'react';\r\nimport {\r\n    withScriptjs,\r\n    withGoogleMap,\r\n    GoogleMap,\r\n} from \"react-google-maps\";\r\nimport { AroundMarker } from './AroundMarker';\r\nimport { POS_KEY } from '../constants';\r\n\r\nclass NormalAroundMap extends React.Component {\r\n    reloadMarker = () => {\r\n        const center = this.getCenter();\r\n        const radius = this.getRadius();\r\n        this.props.loadPostsByTopic(center, radius);\r\n    }\r\n\r\n    getCenter() {\r\n        const center = this.map.getCenter();\r\n        return { lat: center.lat(), lon: center.lng() };\r\n    }\r\n\r\n    getRadius() {\r\n        const center = this.map.getCenter();\r\n        const bounds = this.map.getBounds();\r\n        if (center && bounds) {\r\n            const ne = bounds.getNorthEast();\r\n            const right = new window.google.maps.LatLng(center.lat(), ne.lng());\r\n            return 0.001 * window.google.maps.geometry.spherical.computeDistanceBetween(center, right);\r\n        }\r\n    }\r\n\r\n\r\n    getMapRef = (mapInstance) => {\r\n        this.map = mapInstance;\r\n        window.map = mapInstance;\r\n    }\r\n\r\n    render() {\r\n        const { lat, lon } = JSON.parse(localStorage.getItem(POS_KEY));\r\n        return (\r\n            <GoogleMap\r\n                ref={this.getMapRef}\r\n                defaultZoom={11}\r\n                defaultCenter={{ lat, lng: lon }}\r\n                onDragEnd={this.reloadMarker}\r\n                onZoomChanged={this.reloadMarker}\r\n            >\r\n                {this.props.posts.map((post) => <AroundMarker post={post} key={post.url} />)}\r\n            </GoogleMap>\r\n        );\r\n    }\r\n}\r\n\r\nexport const AroundMap = withScriptjs(withGoogleMap(NormalAroundMap));\r\n"]},"metadata":{},"sourceType":"module"}