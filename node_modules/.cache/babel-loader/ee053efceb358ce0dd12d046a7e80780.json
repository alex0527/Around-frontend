{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\jiang\\\\Desktop\\\\around\\\\around-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\jiang\\\\Desktop\\\\around\\\\around-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\jiang\\\\Desktop\\\\around\\\\around-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\jiang\\\\Desktop\\\\around\\\\around-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from'react';import{withScriptjs,withGoogleMap,GoogleMap}from\"react-google-maps\";import{AroundMarker}from'./AroundMarker';import{POS_KEY}from'../constants';var NormalAroundMap=/*#__PURE__*/function(_React$Component){_inherits(NormalAroundMap,_React$Component);var _super=_createSuper(NormalAroundMap);function NormalAroundMap(){var _this;_classCallCheck(this,NormalAroundMap);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.reloadMarker=function(){var center=_this.getCenter();var radius=_this.getRadius();_this.props.loadPostsByTopic(center,radius);};_this.getMapRef=function(mapInstance){_this.map=mapInstance;window.map=mapInstance;};return _this;}_createClass(NormalAroundMap,[{key:\"getCenter\",value:function getCenter(){var center=this.map.getCenter();return{lat:center.lat(),lon:center.lng()};}},{key:\"getRadius\",value:function getRadius(){var center=this.map.getCenter();var bounds=this.map.getBounds();if(center&&bounds){var ne=bounds.getNorthEast();var right=new window.google.maps.LatLng(center.lat(),ne.lng());return 0.001*window.google.maps.geometry.spherical.computeDistanceBetween(center,right);}}},{key:\"render\",value:function render(){var _JSON$parse=JSON.parse(localStorage.getItem(POS_KEY)),lat=_JSON$parse.lat,lon=_JSON$parse.lon;return/*#__PURE__*/React.createElement(GoogleMap,{ref:this.getMapRef,defaultZoom:11,defaultCenter:{lat:lat,lng:lon},onDragEnd:this.reloadMarker,onZoomChanged:this.reloadMarker},this.props.posts.map(function(post){return/*#__PURE__*/React.createElement(AroundMarker,{post:post,key:post.url});}));}}]);return NormalAroundMap;}(React.Component);export var AroundMap=withScriptjs(withGoogleMap(NormalAroundMap));","map":{"version":3,"sources":["C:/Users/jiang/Desktop/around/around-web/src/components/AroundMap.js"],"names":["React","withScriptjs","withGoogleMap","GoogleMap","AroundMarker","POS_KEY","NormalAroundMap","reloadMarker","center","getCenter","radius","getRadius","props","loadPostsByTopic","getMapRef","mapInstance","map","window","lat","lon","lng","bounds","getBounds","ne","getNorthEast","right","google","maps","LatLng","geometry","spherical","computeDistanceBetween","JSON","parse","localStorage","getItem","posts","post","url","Component","AroundMap"],"mappings":"opBAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OACIC,YADJ,CAEIC,aAFJ,CAGIC,SAHJ,KAIO,mBAJP,CAKA,OAASC,YAAT,KAA6B,gBAA7B,CACA,OAASC,OAAT,KAAwB,cAAxB,C,GAEMC,CAAAA,e,2WACFC,Y,CAAe,UAAM,CACjB,GAAMC,CAAAA,MAAM,CAAG,MAAKC,SAAL,EAAf,CACA,GAAMC,CAAAA,MAAM,CAAG,MAAKC,SAAL,EAAf,CACA,MAAKC,KAAL,CAAWC,gBAAX,CAA4BL,MAA5B,CAAoCE,MAApC,EACH,C,OAkBDI,S,CAAY,SAACC,WAAD,CAAiB,CACzB,MAAKC,GAAL,CAAWD,WAAX,CACAE,MAAM,CAACD,GAAP,CAAaD,WAAb,CACH,C,wFAnBW,CACR,GAAMP,CAAAA,MAAM,CAAG,KAAKQ,GAAL,CAASP,SAAT,EAAf,CACA,MAAO,CAAES,GAAG,CAAEV,MAAM,CAACU,GAAP,EAAP,CAAqBC,GAAG,CAAEX,MAAM,CAACY,GAAP,EAA1B,CAAP,CACH,C,6CAEW,CACR,GAAMZ,CAAAA,MAAM,CAAG,KAAKQ,GAAL,CAASP,SAAT,EAAf,CACA,GAAMY,CAAAA,MAAM,CAAG,KAAKL,GAAL,CAASM,SAAT,EAAf,CACA,GAAId,MAAM,EAAIa,MAAd,CAAsB,CAClB,GAAME,CAAAA,EAAE,CAAGF,MAAM,CAACG,YAAP,EAAX,CACA,GAAMC,CAAAA,KAAK,CAAG,GAAIR,CAAAA,MAAM,CAACS,MAAP,CAAcC,IAAd,CAAmBC,MAAvB,CAA8BpB,MAAM,CAACU,GAAP,EAA9B,CAA4CK,EAAE,CAACH,GAAH,EAA5C,CAAd,CACA,MAAO,OAAQH,MAAM,CAACS,MAAP,CAAcC,IAAd,CAAmBE,QAAnB,CAA4BC,SAA5B,CAAsCC,sBAAtC,CAA6DvB,MAA7D,CAAqEiB,KAArE,CAAf,CACH,CACJ,C,uCAQQ,iBACgBO,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB9B,OAArB,CAAX,CADhB,CACGa,GADH,aACGA,GADH,CACQC,GADR,aACQA,GADR,CAEL,mBACI,oBAAC,SAAD,EACI,GAAG,CAAE,KAAKL,SADd,CAEI,WAAW,CAAE,EAFjB,CAGI,aAAa,CAAE,CAAEI,GAAG,CAAHA,GAAF,CAAOE,GAAG,CAAED,GAAZ,CAHnB,CAII,SAAS,CAAE,KAAKZ,YAJpB,CAKI,aAAa,CAAE,KAAKA,YALxB,EAOK,KAAKK,KAAL,CAAWwB,KAAX,CAAiBpB,GAAjB,CAAqB,SAACqB,IAAD,qBAAU,oBAAC,YAAD,EAAc,IAAI,CAAEA,IAApB,CAA0B,GAAG,CAAEA,IAAI,CAACC,GAApC,EAAV,EAArB,CAPL,CADJ,CAWH,C,6BAzCyBtC,KAAK,CAACuC,S,EA4CpC,MAAO,IAAMC,CAAAA,SAAS,CAAGvC,YAAY,CAACC,aAAa,CAACI,eAAD,CAAd,CAA9B","sourcesContent":["import React from 'react';\r\nimport {\r\n    withScriptjs,\r\n    withGoogleMap,\r\n    GoogleMap,\r\n} from \"react-google-maps\";\r\nimport { AroundMarker } from './AroundMarker';\r\nimport { POS_KEY } from '../constants';\r\n\r\nclass NormalAroundMap extends React.Component {\r\n    reloadMarker = () => {\r\n        const center = this.getCenter();\r\n        const radius = this.getRadius();\r\n        this.props.loadPostsByTopic(center, radius);\r\n    }\r\n\r\n    getCenter() {\r\n        const center = this.map.getCenter();\r\n        return { lat: center.lat(), lon: center.lng() };\r\n    }\r\n\r\n    getRadius() {\r\n        const center = this.map.getCenter();\r\n        const bounds = this.map.getBounds();\r\n        if (center && bounds) {\r\n            const ne = bounds.getNorthEast();\r\n            const right = new window.google.maps.LatLng(center.lat(), ne.lng());\r\n            return 0.001 * window.google.maps.geometry.spherical.computeDistanceBetween(center, right);\r\n        }\r\n    }\r\n\r\n\r\n    getMapRef = (mapInstance) => {\r\n        this.map = mapInstance;\r\n        window.map = mapInstance;\r\n    }\r\n\r\n    render() {\r\n        const { lat, lon } = JSON.parse(localStorage.getItem(POS_KEY));\r\n        return (\r\n            <GoogleMap\r\n                ref={this.getMapRef}\r\n                defaultZoom={11}\r\n                defaultCenter={{ lat, lng: lon }}\r\n                onDragEnd={this.reloadMarker}\r\n                onZoomChanged={this.reloadMarker}\r\n            >\r\n                {this.props.posts.map((post) => <AroundMarker post={post} key={post.url} />)}\r\n            </GoogleMap>\r\n        );\r\n    }\r\n}\r\n\r\nexport const AroundMap = withScriptjs(withGoogleMap(NormalAroundMap));\r\n"]},"metadata":{},"sourceType":"module"}